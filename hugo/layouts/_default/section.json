{{ $published := where (where .CurrentSection.RegularPages "Params.private" "!=" true) "Params.secondaryLang" "!=" true }}
{{ if eq .Type "base" }}
{{ $published = sort $published "Params.Weight" "desc"  }}
{{ end }}
{
  "type": "{{ .Type }}",
  "term": "{{ .Title }}",
  "pages": [
    {{ range $index, $page := $published }}
    {
      "title": "{{ $page.Title }}",
      {{ with $page.Params.subtitle }}"subtitle": "{{ $page.Params.subtitle }}",{{ end }}
      "slug": "{{ $page.Slug }}",  
      {{ with $page.Params.Lang}}"lang": "{{ $page.Params.Lang }}", {{ end }}
      {{ if eq $index 0 }}"cover": "{{ $page.Params.cover }}", {{ end }}
      "words": {{ $page.WordCount }},
      "category": "{{ $page.Params.category }}",
      "date": "{{ $page.Date.Format `2006-01-02T15:04:05+0800` }}"
    }{{ if lt $index (sub (len $published) 1) }},{{ end }}
    {{ end }}
  ]
}
